---
title: "data_clean"
author: "jayden b"
date: "2025-06-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(dplyr)
library(tidyverse)
```

```{r}
og_test_meta <- read.csv("data/neopele_neotrioalone_meta.csv")
og_test_meta

og_test_meta$patient_id <- gsub("S")

og_test_meta<- og_test_meta %>%
  mutate(patient_id = sub("_S[0-9]+$", "", sample_id))

og_test_meta
```
```{r}
neopele_clinical_data <- read.csv("data/neopele_clinical_data.csv")
colnames(neopele_clinical_data)[2] <- "patient_id"
neopele_clinical_data
```

```{r}

neopele_clinical_data_renamed <- neopele_clinical_data %>%
  rename(sample_id = Sample.name, neopele_patient_id = patient_id)

# 2. Left join to bring neopele_patient_id into og_test_meta
og_test_meta_updated <- og_test_meta %>%
  left_join(neopele_clinical_data_renamed %>% select(sample_id, neopele_patient_id), by = "sample_id")

# 3. Replace 'patient_id' in og_test_meta with neopele_patient_id where available
og_test_meta_updated <- og_test_meta_updated %>%
  mutate(patient_id = ifelse(!is.na(neopele_patient_id), as.character(neopele_patient_id), patient_id)) %>%
  select(-neopele_patient_id)  # optional: drop the extra column


og_test_meta_updated
```


```{r}
surv_data <- read.csv("data/surv_data.csv")
surv_data
```
```{r}
merge_surv_data <- merge(
og_test_meta_updated,surv_data, by = "patient_id")

merge_surv_data

write.csv(merge_surv_data,"data/neopele_neotrio_clinical_data.csv")
```


